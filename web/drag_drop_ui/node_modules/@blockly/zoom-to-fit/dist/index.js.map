{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@blockly/zoom-to-fit/webpack/universalModuleDefinition","webpack://@blockly/zoom-to-fit/external umd {\"root\":\"Blockly\",\"commonjs\":\"blockly/core\",\"commonjs2\":\"blockly/core\",\"amd\":\"blockly/core\"}","webpack://@blockly/zoom-to-fit/webpack/bootstrap","webpack://@blockly/zoom-to-fit/webpack/runtime/compat get default export","webpack://@blockly/zoom-to-fit/webpack/runtime/define property getters","webpack://@blockly/zoom-to-fit/webpack/runtime/hasOwnProperty shorthand","webpack://@blockly/zoom-to-fit/webpack/runtime/make namespace object","webpack://@blockly/zoom-to-fit/./src/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"blockly/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"blockly/core\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"blockly/core\")) : factory(root[\"Blockly\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, (__WEBPACK_EXTERNAL_MODULE__573__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__573__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as Blockly from 'blockly/core';\n\n/**\n * Class for zoom to fit control.\n */\nexport class ZoomToFitControl implements Blockly.IPositionable {\n  /**\n   * The unique id for this component.\n   */\n  id = 'zoomToFit';\n\n  /**\n   * The SVG group containing the zoom-to-fit control.\n   */\n  private svgGroup: SVGElement | null = null;\n\n  /**\n   * Left coordinate of the zoom-to-fit control.\n   */\n  private left = 0;\n\n  /**\n   * Top coordinate of the zoom-to-fit control.\n   */\n  private top = 0;\n\n  /**\n   * Width of the zoom-to-fit control.\n   */\n  private readonly width = 32;\n\n  /**\n   * Height of the zoom-to-fit control.\n   */\n  private readonly height = 32;\n\n  /**\n   * Distance between zoom-to-fit control and bottom or top edge of workspace.\n   */\n  private readonly marginVertical = 20;\n\n  /**\n   * Distance between zoom-to-fit control and right or left edge of workspace.\n   */\n  private readonly marginHorizontal = 20;\n\n  /**\n   * Whether this has been initialized.\n   */\n  private initialized = false;\n\n  private onZoomToFitWrapper: Blockly.browserEvents.Data | null = null;\n\n  /**\n   * Constructor for zoom-to-fit control.\n   *\n   * @param workspace The workspace that the zoom-to-fit\n   *     control will be added to.\n   */\n  constructor(protected workspace: Blockly.WorkspaceSvg) {}\n\n  /**\n   * Initializes the zoom reset control.\n   */\n  init() {\n    this.workspace.getComponentManager().addComponent({\n      component: this,\n      weight: 2,\n      capabilities: [Blockly.ComponentManager.Capability.POSITIONABLE],\n    });\n    this.createDom();\n    this.initialized = true;\n    this.workspace.resize();\n  }\n  /**\n   * Disposes of workspace search.\n   * Unlink from all DOM elements and remove all event listeners\n   * to prevent memory leaks.\n   */\n  dispose() {\n    if (this.svgGroup) {\n      Blockly.utils.dom.removeNode(this.svgGroup);\n    }\n    if (this.onZoomToFitWrapper) {\n      Blockly.browserEvents.unbind(this.onZoomToFitWrapper);\n      this.onZoomToFitWrapper = null;\n    }\n  }\n\n  /**\n   * Creates DOM for ui element.\n   */\n  private createDom() {\n    this.svgGroup = Blockly.utils.dom.createSvgElement(\n      Blockly.utils.Svg.IMAGE,\n      {\n        height: `${this.height}px`,\n        width: `${this.width}px`,\n        class: 'zoomToFit',\n      },\n    );\n    this.svgGroup.setAttributeNS(\n      Blockly.utils.dom.XLINK_NS,\n      'xlink:href',\n      zoomToFitSvgDataUri,\n    );\n\n    Blockly.utils.dom.insertAfter(\n      this.svgGroup,\n      this.workspace.getBubbleCanvas(),\n    );\n\n    // Attach listener.\n    this.onZoomToFitWrapper = Blockly.browserEvents.conditionalBind(\n      this.svgGroup,\n      'mousedown',\n      null,\n      this.onClick.bind(this),\n    );\n  }\n\n  /**\n   * Handle click event.\n   */\n  private onClick() {\n    this.workspace.zoomToFit();\n    const uiEvent = new (Blockly.Events.get(Blockly.Events.CLICK))(\n      null,\n      this.workspace.id,\n      'zoom_reset_control',\n    );\n    Blockly.Events.fire(uiEvent);\n  }\n\n  /**\n   * Returns the bounding rectangle of the UI element in pixel units relative to\n   * the Blockly injection div.\n   *\n   * @returns The componentâ€™s bounding box.\n   */\n  getBoundingRectangle(): Blockly.utils.Rect {\n    return new Blockly.utils.Rect(\n      this.top,\n      this.top + this.height,\n      this.left,\n      this.left + this.width,\n    );\n  }\n\n  /**\n   * Positions the zoom-to-fit control.\n   * It is positioned in the opposite corner to the corner the\n   * categories/toolbox starts at.\n   *\n   * @param metrics The workspace metrics.\n   * @param savedPositions List of rectangles that\n   *     are already on the workspace.\n   */\n  position(\n    metrics: Blockly.MetricsManager.UiMetrics,\n    savedPositions: Blockly.utils.Rect[],\n  ) {\n    if (!this.initialized) {\n      return;\n    }\n    const hasVerticalScrollbars =\n      this.workspace.scrollbar &&\n      this.workspace.scrollbar.canScrollHorizontally();\n    const hasHorizontalScrollbars =\n      this.workspace.scrollbar &&\n      this.workspace.scrollbar.canScrollVertically();\n\n    if (\n      metrics.toolboxMetrics.position === Blockly.TOOLBOX_AT_LEFT ||\n      (this.workspace.horizontalLayout && !this.workspace.RTL)\n    ) {\n      // Right corner placement.\n      this.left =\n        metrics.absoluteMetrics.left +\n        metrics.viewMetrics.width -\n        this.width -\n        this.marginHorizontal;\n      if (hasVerticalScrollbars && !this.workspace.RTL) {\n        this.left -= Blockly.Scrollbar.scrollbarThickness;\n      }\n    } else {\n      // Left corner placement.\n      this.left = this.marginHorizontal;\n      if (hasVerticalScrollbars && this.workspace.RTL) {\n        this.left += Blockly.Scrollbar.scrollbarThickness;\n      }\n    }\n\n    const startAtBottom =\n      metrics.toolboxMetrics.position !== Blockly.TOOLBOX_AT_BOTTOM;\n    if (startAtBottom) {\n      // Bottom corner placement\n      this.top =\n        metrics.absoluteMetrics.top +\n        metrics.viewMetrics.height -\n        this.height -\n        this.marginVertical;\n      if (hasHorizontalScrollbars) {\n        // The horizontal scrollbars are always positioned on the bottom.\n        this.top -= Blockly.Scrollbar.scrollbarThickness;\n      }\n    } else {\n      // Upper corner placement\n      this.top = metrics.absoluteMetrics.top + this.marginVertical;\n    }\n\n    // Check for collision and bump if needed.\n    let boundingRect = this.getBoundingRectangle();\n    for (let i = 0, otherEl; (otherEl = savedPositions[i]); i++) {\n      if (boundingRect.intersects(otherEl)) {\n        if (startAtBottom) {\n          // Bump up.\n          this.top = otherEl.top - this.height - this.marginVertical;\n        } else {\n          // Bump down.\n          this.top = otherEl.bottom + this.marginVertical;\n        }\n        // Recheck other savedPositions\n        boundingRect = this.getBoundingRectangle();\n        i = -1;\n      }\n    }\n\n    this.svgGroup?.setAttribute(\n      'transform',\n      `translate(${this.left}, ${this.top})`,\n    );\n  }\n}\n\n/**\n * Base64 encoded data uri for zoom to fit icon.\n */\nconst zoomToFitSvgDataUri =\n  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC' +\n  '9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZm' +\n  'lsbD0iIzU0NkU3QSI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PH' +\n  'BhdGggZD0iTTUgNi40Mkw4LjA5IDkuNSA5LjUgOC4wOSA2LjQxIDVIOVYzSDN2Nmgyem0xMC' +\n  '0zLjQxdjJoMi41N0wxNC41IDguMDlsMS40MSAxLjQxTDE5IDYuNDFWOWgyVjMuMDF6bTQgMT' +\n  'QuNTdsLTMuMDktMy4wOC0xLjQxIDEuNDFMMTcuNTkgMTlIMTV2Mmg2di02aC0yek04LjA5ID' +\n  'E0LjVMNSAxNy41OVYxNUgzdjZoNnYtMkg2LjQybDMuMDgtMy4wOXoiLz48L3N2Zz4=';\n\nBlockly.Css.register(`\n.zoomToFit {\n  opacity: 0.4;\n}\n.zoomToFit:hover {\n  opacity: 0.6;\n}\n.zoomToFit:active {\n  opacity: 0.8;\n}\n`);\n"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE__573__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","ZoomToFitControl","constructor","workspace","id","svgGroup","left","top","width","height","marginVertical","marginHorizontal","initialized","onZoomToFitWrapper","init","getComponentManager","addComponent","component","weight","capabilities","createDom","resize","dispose","class","setAttributeNS","zoomToFitSvgDataUri","getBubbleCanvas","onClick","bind","zoomToFit","uiEvent","getBoundingRectangle","position","metrics","savedPositions","hasVerticalScrollbars","scrollbar","canScrollHorizontally","hasHorizontalScrollbars","canScrollVertically","toolboxMetrics","horizontalLayout","RTL","absoluteMetrics","viewMetrics","startAtBottom","boundingRect","otherEl","intersects","bottom","setAttribute"],"sourceRoot":""}